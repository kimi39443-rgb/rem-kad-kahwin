<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jemputan Digital</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <style>
    :root{
      --bg1:#070707; --bg2:#000;
      --card: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --text: #fff;
      --muted: rgba(255,255,255,.70);
      --accent: #d4af37;
      --radius: 28px;
    }
    body{
      margin:0;
      color:var(--text);
      background:
        radial-gradient(900px 520px at 20% 10%, rgba(255,255,255,.07), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    .glass{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
      position: relative;
      overflow: hidden;
    }

    /* ‚ú® Watermark Diagonal Premium */
    .wm-wrap{
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 40;
      opacity: .18;
      mix-blend-mode: overlay;
    }
    .wm{
      position: absolute;
      left: -20%;
      top: 30%;
      width: 140%;
      transform: rotate(-18deg);
      display: flex;
      flex-direction: column;
      gap: 18px;
      filter: blur(.0px);
    }
    .wm-row{
      display:flex;
      gap: 26px;
      white-space: nowrap;
      font-weight: 800;
      letter-spacing: .35em;
      text-transform: uppercase;
      font-size: 13px;
      color: rgba(255,255,255,.9);
      text-shadow: 0 0 10px rgba(0,0,0,.35);
      animation: wmMove 18s linear infinite;
    }
    .wm-row:nth-child(2){ animation-duration: 22s; opacity:.9; }
    .wm-row:nth-child(3){ animation-duration: 26s; opacity:.75; }
    @keyframes wmMove{
      from{ transform: translateX(-6%); }
      to{ transform: translateX(6%); }
    }

    .chip{ border:1px solid var(--stroke); background: rgba(0,0,0,.25); }
    .btn{
      border-radius: 16px;
      border: 1px solid var(--stroke);
      padding: 12px 14px;
      background: rgba(0,0,0,.22);
    }
    .btnPrimary{
      background: var(--accent);
      color: #0b0b0b;
      border-color: rgba(255,255,255,.18);
      font-weight: 800;
    }
    .input{
      width:100%;
      border-radius: 16px;
      border:1px solid var(--stroke);
      padding: 12px 14px;
      background: rgba(0,0,0,.25);
      outline:none;
    }
    .qrWrap{
      border-radius: 20px;
      border: 1px solid var(--stroke);
      background: rgba(0,0,0,.18);
      padding: 14px;
      display: inline-block;
    }

    /* Intro gate */
    .gate{
      position: fixed; inset:0;
      background:
        radial-gradient(900px 520px at 20% 10%, rgba(255,255,255,.08), transparent 55%),
        linear-gradient(180deg, #070707, #000);
      display:flex; align-items:center; justify-content:center;
      z-index: 60;
      padding: 24px;
    }
    .fadeUp{ animation: fadeUp .65s ease both; }
    @keyframes fadeUp{ from{opacity:0; transform: translateY(14px)} to{opacity:1; transform:none} }
  </style>
</head>

<body class="p-4 max-w-[560px] mx-auto">

  <!-- Watermark overlay -->
  <div class="wm-wrap" id="wmWrap">
    <div class="wm" id="wm">
      <div class="wm-row" id="wm1"></div>
      <div class="wm-row" id="wm2"></div>
      <div class="wm-row" id="wm3"></div>
    </div>
  </div>

  <!-- INTRO GATE -->
  <div id="gate" class="gate">
    <div class="w-full max-w-md glass p-6 text-center space-y-4 fadeUp">
      <div class="text-xs tracking-[.35em] uppercase opacity-70" id="gLabel">Walimatul Urus</div>
      <div class="text-3xl font-extrabold" id="gTitle">Jemputan Digital</div>
      <div class="text-white/70 text-sm" id="gDesc">Klik untuk buka jemputan.</div>

      <div class="grid grid-cols-2 gap-2 pt-2">
        <button id="btnEnter" class="btn btnPrimary">Buka</button>
        <button id="btnMute" class="btn">Muzik: Off</button>
      </div>

      <div class="text-xs opacity-50">¬© R-E-M Digital Invitation</div>
    </div>
  </div>

  <!-- MAIN CARD -->
  <div class="glass p-6 text-center space-y-5 fadeUp">
    <div class="flex items-center justify-between gap-2">
      <div class="flex items-center gap-2">
        <span id="chipPkg" class="chip text-xs px-3 py-2 rounded-full">PKG</span>
        <span id="chipStyle" class="chip text-xs px-3 py-2 rounded-full">Style</span>
        <span id="chipVer" class="chip text-xs px-3 py-2 rounded-full">v</span>
      </div>

      <select id="verPicker" class="chip text-sm px-3 py-2 rounded-full bg-transparent">
        <option value="1">Versi 1</option>
        <option value="2">Versi 2</option>
        <option value="3">Versi 3</option>
        <option value="4">Versi 4</option>
        <option value="5">Versi 5</option>
      </select>
    </div>

    <div class="space-y-2">
      <div class="text-xs tracking-[.35em] uppercase opacity-70" id="labelTop">Walimatul Urus</div>
      <h1 id="outNames" class="text-4xl font-extrabold leading-tight">Adam & Hawa</h1>
      <p id="outLine" class="text-white/70">Dengan penuh kesyukuran, kami menjemput Dato‚Äô/Datin/Tuan/Puan/Encik/Cik</p>
    </div>

    <div class="border-t border-white/10 pt-4 space-y-2 text-sm text-white/80">
      <div>üìÖ <span id="outDate">Sabtu, 12 Oktober 2025</span></div>
      <div>üïö <span id="outTime">11.00 pagi ‚Äì 4.00 petang</span></div>
      <div>üìç <span id="outLoc">Dewan Seri Melur</span></div>
    </div>

    <div class="space-y-3 pt-2">
      <input id="guest" class="input" placeholder="Nama tetamu" />
      <div class="grid grid-cols-2 gap-3">
        <button class="btn btnPrimary" onclick="rsvp('Hadir')" id="btnHadir">Hadir</button>
        <button class="btn" onclick="rsvp('Tidak Hadir')" id="btnTidak">Tidak Hadir</button>
      </div>

      <div class="grid grid-cols-2 gap-3">
        <button class="btn" id="btnCopy">Copy Link</button>
        <button class="btn hidden" id="btnMaps">Buka Maps</button>
      </div>
    </div>

    <div class="pt-2">
      <div class="qrWrap">
        <div id="qrcode"></div>
      </div>
    </div>

    <div class="text-xs opacity-60" id="footLine">Jemputan Digital ‚Ä¢ Mesra Telefon üì±</div>
    <div class="pt-4 text-xs opacity-40 select-none text-center">
  <button id="wmTap" type="button" class="underline decoration-white/20">
    ¬© R-E-M Digital Invitation
  </button>

  <a id="adminLink"
     class="hidden ml-2 px-3 py-1 rounded-full bg-white/10 border border-white/10"
     href="./admin.html">
     Admin
  </a>
    </div>
  </div>

<script>
/* =========================
   CONFIG DEFAULT (fallback)
========================= */
const CONFIG = {
  WA_PHONE: "601111661303",
  MAPS_URL: "",
  EVENT: {
    names: "Adam & Hawa",
    date: "Sabtu, 12 Oktober 2025",
    time: "11.00 pagi ‚Äì 4.00 petang",
    location: "Dewan Seri Melur"
  },
  MUSIC_URL: ""
};

/* =========================
   Read params
========================= */
const p = new URLSearchParams(location.search);
const pkg = (p.get("pkg") || "pro").toLowerCase();
let v = parseInt(p.get("v") || "1", 10);

const allowByPkg = {
  basic: [1],
  vip: [1,2,3],
  pro: [1,2,3,4,5]
};
const allowed = allowByPkg[pkg] || allowByPkg.pro;
if (!allowed.includes(v)) v = allowed[0];

/* Override CONFIG from URL */
(function applyOverrides(){
  if (p.get("wa"))    CONFIG.WA_PHONE = (p.get("wa") || "").trim().replace(/[^\d]/g,"");
  if (p.get("maps"))  CONFIG.MAPS_URL = (p.get("maps") || "").trim();
  if (p.get("music")) CONFIG.MUSIC_URL = (p.get("music") || "").trim();

  if (p.get("names")) CONFIG.EVENT.names = (p.get("names") || "").trim();
  if (p.get("date"))  CONFIG.EVENT.date  = (p.get("date")  || "").trim();
  if (p.get("time"))  CONFIG.EVENT.time  = (p.get("time")  || "").trim();
  if (p.get("loc"))   CONFIG.EVENT.location = (p.get("loc") || "").trim();
})();

/* =========================
   Themes v1‚Äìv5
========================= */
const THEMES = {
  1: { style:"Premium",  accent:"#d4af37", bg1:"#0b0b0b", bg2:"#000000", card:"rgba(255,255,255,.06)" },
  2: { style:"Modern",   accent:"#39ffcf", bg1:"#070a12", bg2:"#000000", card:"rgba(57,255,207,.06)" },
  3: { style:"Minimal",  accent:"#ffffff", bg1:"#0a0a0a", bg2:"#000000", card:"rgba(255,255,255,.06)" },
  4: { style:"Islamic",  accent:"#2ecc71", bg1:"#07120a", bg2:"#000000", card:"rgba(46,204,113,.06)" },
  5: { style:"Royal",    accent:"#a78bfa", bg1:"#0a0712", bg2:"#000000", card:"rgba(167,139,250,.06)" },
};

function applyTheme(ver){
  const t = THEMES[ver] || THEMES[1];
  document.documentElement.style.setProperty("--accent", t.accent);
  document.documentElement.style.setProperty("--bg1", t.bg1);
  document.documentElement.style.setProperty("--bg2", t.bg2);
  document.documentElement.style.setProperty("--card", t.card);

  chipStyle.textContent = t.style;
  chipVer.textContent = "v" + ver;
  verPicker.value = String(ver);
}

/* =========================
   BM/EN auto (simple)
========================= */
const isEN = (navigator.language || "").toLowerCase().startsWith("en");
const T = {
  labelTop: isEN ? "Wedding Invitation" : "Walimatul Urus",
  line: isEN ? "With gratitude, we invite you to attend" : "Dengan penuh kesyukuran, kami menjemput Dato‚Äô/Datin/Tuan/Puan/Encik/Cik",
  hadir: isEN ? "Attend" : "Hadir",
  tidak: isEN ? "Not attending" : "Tidak Hadir",
  copy: isEN ? "Copy Link" : "Copy Link",
  maps: isEN ? "Open Maps" : "Buka Maps",
  foot: isEN ? "Digital Invitation ‚Ä¢ Mobile-friendly" : "Jemputan Digital ‚Ä¢ Mesra Telefon üì±",
  gateDesc: isEN ? "Tap to open the invitation." : "Klik untuk buka jemputan.",
  musicOn: isEN ? "Music: On" : "Muzik: On",
  musicOff: isEN ? "Music: Off" : "Muzik: Off",
  open: isEN ? "Open" : "Buka",
};

/* =========================
   Render
========================= */
chipPkg.textContent = (pkg || "pro").toUpperCase();
labelTop.textContent = T.labelTop;
outLine.textContent = T.line;
btnHadir.textContent = T.hadir;
btnTidak.textContent = T.tidak;
btnCopy.textContent = T.copy;
btnMaps.textContent = T.maps;
footLine.textContent = T.foot;

outNames.textContent = CONFIG.EVENT.names;
outDate.textContent = CONFIG.EVENT.date;
outTime.textContent = CONFIG.EVENT.time;
outLoc.textContent  = CONFIG.EVENT.location;

gLabel.textContent = T.labelTop;
gDesc.textContent = T.gateDesc;
btnEnter.textContent = T.open;

/* Name auto */
const presetName = (p.get("name") || "").trim();
if (presetName) guest.value = presetName;

/* =========================
   Watermark premium (diagonal)
========================= */
function setWatermark(){
  const pkgName = (pkg || "pro").toUpperCase();
  const styleName = (THEMES[v]?.style || "PREMIUM").toUpperCase();
  const tag = `R-E-M ‚Ä¢ ${pkgName} ‚Ä¢ V${v} ‚Ä¢ ${styleName}`;

  // repeat text
  const makeRow = () => Array.from({length: 8}).map(()=>tag).join("   ‚Ä¢   ");

  wm1.textContent = makeRow();
  wm2.textContent = makeRow();
  wm3.textContent = makeRow();

  // stronger for Basic
  if ((pkg||"").toLowerCase() === "basic") {
    document.getElementById("wmWrap").style.opacity = ".26";
  }
}
setWatermark();

/* =========================
   Version picker + lock by package
========================= */
function refreshPickerOptions(){
  [...verPicker.options].forEach(opt=>{
    const n = parseInt(opt.value,10);
    opt.disabled = !allowed.includes(n);
    opt.textContent = "Versi " + n + (opt.disabled ? " (Lock)" : "");
  });
}
refreshPickerOptions();
applyTheme(v);

verPicker.addEventListener("change", ()=>{
  const next = parseInt(verPicker.value,10);
  if (!allowed.includes(next)) return;

  v = next;
  p.set("v", String(v));
  p.set("pkg", pkg);
  history.replaceState(null, "", location.pathname + "?" + p.toString());

  applyTheme(v);
  refreshPickerOptions();
  rebuildQR();
  setWatermark();
});

/* =========================
   QR + Copy + Maps
========================= */
function rebuildQR(){
  const el = document.getElementById("qrcode");
  el.innerHTML = "";
  new QRCode(el, {
    text: window.location.href,
    width: 210,
    height: 210,
    colorDark: "#ffffff",
    colorLight: "transparent"
  });
}
rebuildQR();

btnCopy.addEventListener("click", async ()=>{
  try{
    await navigator.clipboard.writeText(window.location.href);
    btnCopy.textContent = "Copied!";
    setTimeout(()=>btnCopy.textContent = T.copy, 1100);
  }catch(e){
    alert(window.location.href);
  }
});

if (CONFIG.MAPS_URL){
  btnMaps.classList.remove("hidden");
  btnMaps.addEventListener("click", ()=> window.open(CONFIG.MAPS_URL, "_blank"));
}

/* =========================
   RSVP WhatsApp (correct)
========================= */
function rsvp(status){
  const guestName = (guest.value || "").trim();
  const msg =
`RSVP ${status}
Nama: ${guestName || "-"}
Majlis: ${CONFIG.EVENT.names}
Tarikh: ${CONFIG.EVENT.date}
Lokasi: ${CONFIG.EVENT.location}`;

  const url = "https://wa.me/" + CONFIG.WA_PHONE + "?text=" + encodeURIComponent(msg);
  const w = window.open(url, "_blank");
  if (!w) window.location.href = url; // popup-proof fallback
}
window.rsvp = rsvp;

/* =========================
   Intro gate + music (optional)
========================= */
let audio = null;
let musicOn = false;

function setupAudio(){
  if (!CONFIG.MUSIC_URL) return;
  audio = new Audio(CONFIG.MUSIC_URL);
  audio.loop = true;
  audio.volume = 0.7;
}
setupAudio();

btnMute.textContent = T.musicOff;
btnMute.addEventListener("click", ()=>{
  musicOn = !musicOn;
  btnMute.textContent = musicOn ? T.musicOn : T.musicOff;
});

btnEnter.addEventListener("click", ()=>{
  gate.style.display = "none";
  if (musicOn && audio){
    audio.play().catch(()=>{});
  }
});// Hidden Admin bila tekan watermark 7x
(function(){
  const wm = document.getElementById("wmTap");
  const admin = document.getElementById("adminLink");
  if(!wm || !admin) return;

  let taps = 0, tmr = null;
  wm.addEventListener("click", ()=>{
    taps++;
    clearTimeout(tmr);
    tmr = setTimeout(()=> taps=0, 1500);
    if(taps >= 7){
      admin.classList.remove("hidden");
      taps = 0;
    }
  });
})();
</script>
</body>
</html>
