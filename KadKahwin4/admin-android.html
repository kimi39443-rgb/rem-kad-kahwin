
<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Admin Android</title>
  <style>
    *{ box-sizing:border-box; }
    body{
      margin:0;
      background:#0b0c10;
      color:#fff;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .page{ max-width: 760px; margin:0 auto; padding: 18px 14px 30px; }
    .head{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 18px;
      padding: 14px;
      margin-bottom: 12px;
    }
    h1{ margin:0 0 6px; font-size: 20px; letter-spacing:.2px; }
    .sub{ opacity:.8; font-size: 13px; line-height:1.4; }

    .grid{
      display:grid;
      gap:10px;
      grid-template-columns: 1fr;
    }
    .card{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 18px;
      padding: 14px;
    }
    .row{ display:grid; gap:8px; margin-bottom: 10px; }
    label{ font-size: 12px; opacity:.85; }
    input, select, textarea{
      width:100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      color:#fff;
      outline:none;
      font:inherit;
      min-height: 46px;
    }
    textarea{ min-height: 90px; resize: vertical; }
    .btnRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top: 12px;
    }
    .btn{
      min-height: 48px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.10);
      color:#fff;
      font-weight: 850;
      cursor:pointer;
    }
    .btnPrimary{
      background: #e7c96e;
      color:#09110d;
      border:none;
    }
    .btnFull{ grid-column: 1 / -1; }
    .hint{ font-size: 12px; opacity:.75; line-height:1.45; margin-top:10px; }
    .out{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      background: rgba(0,0,0,.35);
      border:1px dashed rgba(255,255,255,.18);
      border-radius: 14px;
      padding: 10px;
      word-break: break-all;
      margin-top: 10px;
    }
  </style>
</head>
<body>
<div class="page">
  <div class="head">
    <h1>Admin Android (Stabil)</h1>
    <div class="sub">Edit ‚Üí <b>Simpan</b> (untuk owner) ‚Üí <b>Generate</b> (link tetamu ada <code>?d=</code>) ‚Üí <b>Copy Link</b>.</div>
  </div>

  <div class="grid">
    <div class="card">
      <div class="row">
        <label>Base URL invite.html (WAJIB)</label>
        <input id="baseUrl" placeholder="https://.../KadKahwin4/invite.html" />
      </div>

      <div class="row">
        <label>Tema</label>
        <select id="theme">
          <option value="floral">Floral</option>
          <option value="gold" selected>Gold</option>
          <option value="midnight">Midnight</option>
          <option value="emerald">Emerald</option>
        </select>
      </div>

      <div class="row">
        <label>Video Background</label>
        <select id="videoOn">
          <option value="0">OFF (lebih stabil)</option>
          <option value="1">ON</option>
        </select>
      </div>
    </div>

    <div class="card">
      <div class="row"><label>Top Title</label><input id="topTitle" placeholder="Kad Kahwin Digital"></div>
      <div class="row"><label>Top Subtitle</label><input id="topSubtitle" placeholder="Jemputan Rasmi"></div>
      <div class="row"><label>Badge</label><input id="badge" placeholder="WEDDING INVITATION"></div>

      <div class="row"><label>Tajuk</label><input id="title" placeholder="Walimatul Urus"></div>
      <div class="row"><label>Nama Pengantin</label><input id="couple" placeholder="Adam & Hawa"></div>
      <div class="row"><label>Tarikh</label><input id="date" placeholder="01/12/2025"></div>
      <div class="row"><label>Masa</label><input id="time" placeholder="9.00am ‚Äì 2.00pm"></div>
      <div class="row"><label>Tempat / Dewan</label><input id="venue" placeholder="Dewan Serbaguna"></div>
      <div class="row"><label>Alamat Ringkas</label><input id="address" placeholder="Alamat ringkas majlis di sini"></div>

      <div class="row"><label>Link Google Maps</label><input id="maps" placeholder="https://maps.google.com/"></div>
      <div class="row"><label>Link WhatsApp RSVP</label><input id="rsvp" placeholder="https://wa.me/6012..."></div>

      <div class="row"><label>Ayat Jemputan</label><textarea id="message" placeholder="Dengan penuh kesyukuran..."></textarea></div>
      <div class="row"><label>Notis</label><input id="notice" placeholder="Notis: Dilarang guna/jual..."></div>
    </div>

    <div class="card">
      <div class="row">
        <label>Nama tetamu (untuk link)</label>
        <input id="guest" placeholder="Contoh: Karim & Masni / Tetamu VIP">
      </div>

      <div class="btnRow">
        <button class="btn btnPrimary" id="btnSave">üíæ Simpan</button>
        <button class="btn btnPrimary" id="btnGen">üîÅ Generate</button>
        <button class="btn" id="btnCopy">üìã Copy Link</button>
        <button class="btn" id="btnOpen">üîó Buka Invite</button>
        <button class="btn btnFull" id="btnReset">üßπ Reset Local</button>
      </div>

      <div class="out" id="outLink">Link akan keluar di sini‚Ä¶</div>
      <div class="hint">Tip: Tetamu mesti guna link yang ada <b>?d=</b> supaya data tak hilang bila buka phone lain.</div>
    </div>
  </div>
</div>

<script>
  const KEY_LOCAL = "KADKAHWIN_DATA_V1";
  const KEY_BASE  = "REM_BASEURL_V1";

  const DEFAULT_DATA = {
    theme:"gold",
    videoOn:false,
    topTitle:"Kad Kahwin Digital",
    topSubtitle:"Jemputan Rasmi",
    badge:"WEDDING INVITATION",
    title:"Walimatul Urus",
    couple:"Adam & Hawa",
    date:"01/12/2025",
    time:"9.00am ‚Äì 2.00pm",
    venue:"Dewan Serbaguna",
    address:"Alamat ringkas majlis di sini",
    maps:"https://maps.google.com/",
    rsvp:"https://wa.me/60123456789?text=Assalamualaikum,%20saya%20nak%20RSVP",
    message:"Dengan penuh kesyukuran, kami menjemput anda hadir bagi memeriahkan majlis perkahwinan kami.",
    notice:"Notis: Dilarang guna/jual page ini tanpa kebenaran pemilik.",
    guest:"Tetamu"
  };

  const $ = (id)=>document.getElementById(id);

  function loadLocal(){
    try{
      const raw = localStorage.getItem(KEY_LOCAL);
      return raw ? JSON.parse(raw) : null;
    }catch(e){ return null; }
  }
  function saveLocal(obj){
    localStorage.setItem(KEY_LOCAL, JSON.stringify(obj));
  }

  function objToB64(obj){
    const json = JSON.stringify(obj);
    return btoa(unescape(encodeURIComponent(json)));
  }

  function getForm(){
    return {
      theme: $("theme").value,
      videoOn: $("videoOn").value === "1",
      topTitle: $("topTitle").value.trim(),
      topSubtitle: $("topSubtitle").value.trim(),
      badge: $("badge").value.trim(),
      title: $("title").value.trim(),
      couple: $("couple").value.trim(),
      date: $("date").value.trim(),
      time: $("time").value.trim(),
      venue: $("venue").value.trim(),
      address: $("address").value.trim(),
      maps: $("maps").value.trim(),
      rsvp: $("rsvp").value.trim(),
      message: $("message").value.trim(),
      notice: $("notice").value.trim(),
      guest: $("guest").value.trim() || "Tetamu"
    };
  }

  function fillForm(d){
    $("theme").value = d.theme || "gold";
    $("videoOn").value = d.videoOn ? "1" : "0";
    $("topTitle").value = d.topTitle || "";
    $("topSubtitle").value = d.topSubtitle || "";
    $("badge").value = d.badge || "";
    $("title").value = d.title || "";
    $("couple").value = d.couple || "";
    $("date").value = d.date || "";
    $("time").value = d.time || "";
    $("venue").value = d.venue || "";
    $("address").value = d.address || "";
    $("maps").value = d.maps || "";
    $("rsvp").value = d.rsvp || "";
    $("message").value = d.message || "";
    $("notice").value = d.notice || "";
    $("guest").value = d.guest || "Tetamu";
  }

  // load base url
  const baseSaved = localStorage.getItem(KEY_BASE) || "";
  $("baseUrl").value = baseSaved;

  // load data
  const init = loadLocal() || DEFAULT_DATA;
  fillForm(init);

  function makeGuestLink(){
    const base = $("baseUrl").value.trim();
    if(!base || !base.includes("invite.html")){
      alert("Base URL mesti lengkap sampai invite.html\nContoh: https://kimi39443-rgb.github.io/rem-kad-kahwin/KadKahwin4/invite.html");
      return "";
    }
    localStorage.setItem(KEY_BASE, base);
    const d = getForm();
    const b64 = objToB64(d);
    const url = new URL(base);
    url.searchParams.set("d", b64);
    return url.toString();
  }

  $("btnSave").addEventListener("click", ()=>{
    const d = getForm();
    saveLocal(d);
    alert("Simpan local (owner) ‚úÖ");
  });

  $("btnGen").addEventListener("click", ()=>{
    const link = makeGuestLink();
    if(!link) return;
    $("outLink").textContent = link;
    alert("Link tetamu siap ‚úÖ (boleh Copy Link)");
  });

  $("btnCopy").addEventListener("click", async ()=>{
    const txt = $("outLink").textContent.trim();
    if(!txt || txt.includes("akan keluar")){
      alert("Tekan Generate dulu.");
      return;
    }
    try{
      await navigator.clipboard.writeText(txt);
      alert("Link di-copy ‚úÖ");
    }catch(e){
      prompt("Copy link ini:", txt);
    }
  });

  $("btnOpen").addEventListener("click", ()=>{
    const txt = $("outLink").textContent.trim();
    const base = $("baseUrl").value.trim();
    if(txt && txt.startsWith("http")) location.href = txt;
    else if(base) location.href = base;
    else alert("Isi Base URL dulu.");
  });

  $("btnReset").addEventListener("click", ()=>{
    if(confirm("Reset local data?")){
      localStorage.removeItem(KEY_LOCAL);
      alert("Local reset ‚úÖ");
      fillForm(DEFAULT_DATA);
      $("outLink").textContent = "Link akan keluar di sini‚Ä¶";
    }
  });
</script>
</body>
</html>
